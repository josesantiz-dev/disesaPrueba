<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:a4j="http://richfaces.org/a4j" 
    xmlns:rich="http://richfaces.org/rich">
    
    <rich:popupPanel id="pnlBusquedaDinamica" autosized="true" domElementAttachment="form" style="min-width:800px; max-width:1024px;" top="20" 
    	header="#{msg['buscar.e']}"
		onshow="document.getElementById('#{rich:clientId('txtValorBusquedaDinamica')}').focus();">
		<f:facet name="controls">
			<h:graphicImage style="cursor:pointer;" 
				value="#{msg['navegacion.gral.cerrar.img']}" 
				onclick="#{rich:component('pnlBusquedaDinamica')}.hide()" />
		</f:facet>
		
		<rich:hotKey id="richHotKeyBusquedaDinamica" enabledInInput="true" preventDefault="true" 
			selector="#txtValorBusquedaDinamica" key="return"
			onkeydown="#{rich:element('frmPrincipal:btnBusquedaDinamica')}.click()" />
		
		<a4j:region id="loadBusquedaDinamica">
			<h:panelGroup style="width:100%; margin:0 auto; padding:0;">
				<h:panelGrid columns="2" columnClasses="colLayoutTop,colLayoutBottom" style="width:100%; margin:0 auto; padding:0; min-height:22px; text-align:left;">
					<h:panelGroup style="width:100%;">
						<h:panelGrid columns="3" cellpadding="0" cellspacing="0">
							<h:inputText id="txtValorBusquedaDinamica" maxlength="50" style="width:210px;"
								value="#{gruposAction.valorBusquedaDinamica}">
								<rich:placeholder value="#{msg['busqueda']}" />
							</h:inputText>
							
							<a4j:commandButton id="btnBusquedaDinamica" style="margin:0 5px; vertical-align: middle; cursor: pointer;" 
								image="#{msg['buscar22.img']}" title="#{msg['buscar.e']}"
								action="#{gruposAction.busquedaDinamica}"
								oncomplete="buscar(#{gruposAction.operacion}, '#{rich:clientId('pnlMensajes')}');" 
								render="dtResultDinamico, pnlMensajes"
								limitRender="true" />
							
							<a4j:commandButton id="btnBusquedaDinamicaAvanzada" execute="@none" type="button"
								image="#{msg['toggle.img']}" title="#{msg['busqueda']} #{msg['avanzada']}"
								onclick="toggleAvanzado(this.id, 'gBusquedaDinamicaAvanzada', 'cdTiposBusquedaDinamica', 'txtValorBusquedaDinamica');" />
						</h:panelGrid>
					</h:panelGroup>
					
					<h:panelGroup style="width:100%;">
					</h:panelGroup>
				</h:panelGrid>
				
				<h:panelGroup id="gBusquedaDinamicaAvanzada" style="display:none; backgroud-color:#e9e9e9; width:100%; margin:5px auto 0; padding:0;">
					<h:panelGrid columns="2" style="margin:0; padding:0; text-align:left;">
						<h:outputText value="#{msg['buscarPor']}:" styleClass="Titulo"/>
						<h:selectOneMenu id="cdTiposBusquedaDinamica" styleClass="Titulo" style="width:216px;"
							value="#{gruposAction.campoBusquedaDinamica}">
							<f:selectItems value="#{gruposAction.tiposBusquedaDinamica}" />
						</h:selectOneMenu>
					</h:panelGrid>
				</h:panelGroup>
				
				<div class="tableParent" style="display:block; margin:10px auto 0; padding:0; width:100%; height:auto; max-height:450px; overflow:auto;">
					<rich:dataTable id="dtResultDinamico" value="#{gruposAction.listValoresDinamicos}" var="var" style="margin:0 auto;" 
						cellpadding="0" cellspacing="0" rows="100" border="0" rowClasses="Row1,Row2" styleClass="tabla_pagina">
						<f:facet name="header">
							<rich:columnGroup>
								<rich:column styleClass="Descripcion" style="text-align:center; padding:2px 4px; width:80px;">
									<h:outputText value="#{msg['id']}" />
								</rich:column>
								
								<rich:column styleClass="Descripcion" style="text-align:center; padding:2px 4px;">
									<h:outputText value="#{msg['descripcion']}" />
								</rich:column>
	
								<rich:column styleClass="Descripcion" style="text-align:center; padding:2px 4px; width:20px;" />
							</rich:columnGroup>
						</f:facet>
						
						<rich:column styleClass="Descripcion" style="text-align:center;">
							<h:outputText value="#{var.value}" styleClass="Descripcion" />
						</rich:column>
						
						<rich:column styleClass="Descripcion" style="text-align:left;">
							<h:outputText value="#{var.label}" styleClass="Descripcion" />
						</rich:column>
						
						<rich:column styleClass="Descripcion" style="text-align:center;">
						   <a4j:commandButton id="cmdSeleccionarValorDinamico" 
						   		image="#{msg['agregar16.img']}" title="#{msg['seleccionar']}"
								action="#{gruposAction.seleccionarValorDinamico}"  
								onclick="seleccionar(#{gruposAction.operacion}, '#{rich:clientId('pnlBusquedaDinamica')}', '#{rich:clientId('pnlMensajes')}');" 
								render="groupLlavesValores,pnlMensajes"
								limitRender="true">
								<f:setPropertyActionListener target="#{gruposAction.pojoValorDinamico}" value="#{var}" for="cmdSeleccionarValorDinamico" />
						   </a4j:commandButton>
						</rich:column>
		
						<f:facet name="footer">
							<rich:dataScroller for="dtResultDinamico" page="#{gruposAction.numPaginaDinamica}"
								ajaxSingle="true" maxPages="10" fastStep="10" align="center" styleClass="Titulo" renderIfSinglePage="false" />
						</f:facet>
					</rich:dataTable>
				</div>
			</h:panelGroup>
		</a4j:region>
	</rich:popupPanel>
</ui:composition>